# GEFs
The toolbox has been primarily developed for filter design and signal processing and analysis purposes as well as for the scientific study of the auditory system pertaining to the cochlea and perceptual studies. The toolbox has been developed such that users with interests and backgrounds in only one of the aforementioned fields may use it without concerning themselves with other functionalities. 


## Capabilities for Filter Design and Filtering
The toolset includes functionalities include filter construction and signal processing using filters for arbitrary filters and signals. It also includes filter design functionalities specific to a class of bandpass filters (referred to as GEFs) and related classes of bandpass filters, multiband filters, and filterbanks. GEFs are bandpass LTI filters with a pair of poles repeated $B_u$ times.

### General Filters and Signals: Constructing Arbitrary Filters, Filterbanks, and Multiband Filters
* Arbitrary filters may be constructed - e.g. using provided poles and zeros, then used for filtering any signal.

### General Filters and Signals: Filtering
* A signal provided as a time-series or a frequency response may be inputted into a constructed or designed filter, filterbank, or multiband filter.
* The output signal may be generated by filtering the input signal using any of several solution methods with some specific to GEFs/GAFs and others that apply more generally.

### General Filters and Signals: Signal Analysis and Plots
* The toolbox includes functionalities for any signal such as autocorrelation and envelope extraction.
* Filterbanks with constitutive filters - each with a different peak frequency, may be used to generate outputs. Plots include the envelope of the output signals as a function of time and peak frequency.

### GEFs: Characteristics-Based Design of Classes of Bandpass Filters (e.g. GEFs)
* Designs certain classes of bandpass filters such as Generalized Exponent Filters (GEFs) also known as Generalized Auditory Filters (GAFs) based on simultaneous specifications on filter characteristics including peak frequencies, quality factors, and group delays. This is as opposed to filter design based on the complex frequency response or its magnitudes or amplitude over a length of frequencies.
* The characteristics-based design method is direct, non-iterartive, highly-accurate for sharp filters, and allows for designing sharp filters with minimal delay.
* The characteristics-based design methods extends beyond GEFs to related bandpass filters (see [3]) as well as to filterbanks and bandpass filters and may be used for adaptive filtering based on variable filter design.
* The accuracy in achieving the desired specifications on filter characteristics is assessed.


### GEFs: Designing and Filtering with Rational Exponent Filters (Rational GEFs)
* In order to access a continuum of filter characteristics, GEFs may have rational exponents rather than being constraint to discrete filter behavior.
* The toolbox includes various solution methods for filtering using rational GEFs.


### GEFs: Potential Signal Processing Applications for GEFs
* Potential applications may benefit from the direct specification over desired characteristics as well as the fine control over the characteristics enabled by the rational exponents primarily include those that make use of bandpass filterbanks and multiband filters. Such applications may include: parameteric equalizers, a front end for speech processing, microseismic signal XXX INSERT. 

### GEFs: Filters Related to GEFs
* Filters related to GEFs include the gammatone family of filters - e.g. Gammatone Filters (GTFs), All-Pole Gammatone Filters (APGFs), One-zero Gammatone Filters (OZGFs) [5]

### GEFs: Highlights for GEFs and Rational GEFs
* Allows for designing filters, filterbanks, and multiband filters by directly dictating or controling specifications on desired filter characteristics such as peak frequencies, quality factors and group delays.
* Enables accessing a continuum of behavior not classically achievable with integer-exponent or integer-order filters.
* Enables solving and filtering with rational-exponent filters


## Capabilities for Studying Auditory Physics and Cochlear Mechanics
* Variables of the cochlear model include (1) response variables (which are related to the filters) that may in principle be observed in some species: differential pressure across the OoC, and OoC velocity, as well (2) mechanistic variables which contain information how the model works: the differential pressure wavenumber, and the effective impedance of the OoC.
* A user may specify a species (human or chinchilla) or model constants that vary slowly along the length of the cochlea to generate the mechanistic variables and functional response variables.
* A user may study the dependence of mechanistic variable behavior on observed response characteristics.
* Alternatively, given reported response characteristics such as quality factors and group delays, the methods can be used to estimate the underlying mechanistic variables which encode properties of interest to auditory physicists such as negative effective damping. This feature is related to the filter design methods mentioned above where desired values for characteristics are provided to design filters (which map onto to response variables in the cochlear model).
* A user may be interested in the model variables from a traveling wave perspective (as a function of $x$ for a constant $\omega$) or from a transfer function perspective (as a function of $\omega$ for a constant $x$). The two perspectives are tied together via an assumption of local scaling symmetry of the wavenumber.
* _Key Assumptions:_ The cochlear model is related to the filterbank and assumes an uncoiled box model of the cochlea with a single partition for the Organ of Corti (OoC). The model is developed based on observations from the response of the active mammalian cochlea to low stimulus levels (and hence linear). The derivation also assumes local scaling symmetry of the wavenumber - i.e. the model constants or filter characteristics such as quality factors vary slowly along the length of the cochlea. Additionally, the scaling factor due to the long-wave region (which is not modeled) is assumed to be frequency independent relative to the model and the magnitudes are adjusted to all have the same peak magnitude.


## Tutorials and Documentation
* Documentation for the toolbox is in `documentation.pdf`. Example plots in the documentation are generated in python using `tutorial.py`. These illustrate a comprehensive set of the toolbox's capabilities.
* `alkhairy2019.m` generates some of the figures in [1] and [2] are are of the greatest interest to those in auditory physics and modeling cochlear mechanisms.
* `alkhairy2024.m` generates some of the figures in [3] and [4] and are of the greatest interest to those in signal processing and filter design.  


## Requirements for Running the Toolbox
The toolbox may be used in Python or MATLAB. In either case, you will need to install Python along with required libraries which are listed in `requirements.txt`.

To install the requirements, run the following in Python 3,

```
$ pip -r install requirements.txt
```

This can be done globally or using a virtual environment - e.g. [see here](https://dev.to/emminex/how-to-install-python-libraries-in-visual-studio-code-38i1).

## Contributing
Before submitting a pull request, please run the tutorial files `tutorial.py`, `alkhairy2019.m`, and `alkhairy2024.m` to make sure that the changes do not break the code. Future releases may include dedicated unit tests.


## References
[1] Alkhairy, S. A., & Shera, C. A. (2019). An analytic physically motivated model of the mammalian cochlea. The Journal of the Acoustical Society of America, 145(1), 45-60. [link](https://doi.org/10.1121/1.5084042).  
[2] Alkhairy, S. A. (2024, February). Cochlear wave propagation and dynamics in the human base and apex: Model-based estimates from noninvasive measurements. In AIP Conference Proceedings (Vol. 3062, No. 1). AIP Publishing. [link](https://doi.org/10.1063/5.0189264).   
[3] Alkhairy, S. A. (2024). Characteristics-Based Design of Multi-Exponent Bandpass Filters. arXiv preprint arXiv:2404.15321. [link](https://arxiv.org/abs/2404.15321v1).  
[4] Alkhairy, S. A. (2024). Rational-Exponent Filters with Applications to Generalized Auditory Filterbanks. arXiv preprint arXiv:2406.16877. [link](https://arxiv.org/abs/2406.16877v2).  
[5]   
[6]   
